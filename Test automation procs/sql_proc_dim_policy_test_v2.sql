/****** Object:  StoredProcedure [dbo].[udsp_test_dim_policy_v2]    Script Date: 22/10/2021 9:52:16 am ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


ALTER PROCEDURE [dbo].[udsp_test_dim_policy_v2] --@sql nvarchar(max) with execute as owner

AS
BEGIN
	declare @vsqletlsp varchar(255) = '[sp_data].[populate_dim_policy]'
			,@vtablename varchar(255) = 'dim_policy'
			,@vcolumnname varchar(255) 
			,@vstartdatetime datetime
			,@venddatetime	datetime
			--- C2 columns
			,@vTypeKey int
			,@vPolicyID int
			,@vPolicyNumber varchar(100)
			,@vProductCode varchar(4)
			--,@vDealerGroupID int
			--,@vCompName varchar(100)
			,@vrecord_startdatetime datetime
			,@vrecord_enddatetime	datetime
			,@vrecord_currentflag	int
			--- C1 variables
			,@VDestinationTable		varchar(255)
			,@vDestinationColumn	varchar(255)
			,@vSourceTableName		varchar(255)
			,@vSourceColumnName		varchar(255)
			,@vSourceDataType		varchar(10)
			,@vsqlnotes			nvarchar(max)
			---- temp table variables
			,@vsqldynamic		nvarchar(max)
			,@vsourcecolumnvalue	varchar(max)
			,@vdestinationcolumnvalue	varchar(max)
			,@vDestinationPrevColumnValue varchar(max)
			,@vcurrentflagpass varchar(1)
			,@vrecord_start_datetpass varchar(1)
			,@vrecord_end_datepass varchar(1) 
			,@vsourcetargetvalues varchar(max)
			,@numberofrows			int = 0


	--declare  @dim_policy_test_results TABLE
	--	(
	--		tablename varchar(255) NOT NULL,
	--		columnname varchar(255) NOT NULL,
	--		sourcetablename varchar(255) NOT NULL,
	--		sourcecolumnname varchar(255) NOT NULL,
	--		policy_key		int  null,
	--		policy_id		int  null,
	--		policy_number varchar(100)  null,
	--		product_code	varchar(4)  null,
	--		currentflagpass varchar(1) NOT NULL,
	--		record_start_datetpass varchar(1) NOT NULL,
	--		record_end_datepass varchar(1) NOT NULL,
	--		sourcetargetvalues varchar(max) null,
	--		update_datetime	datetime null
	--	)
	
	declare  c1 cursor for 
				select DestinationTable, DestinationColumn, SourceTableName, SourceColumnName, SourceDataType, sqlnotes
				from dbo.dim_policy_test_case
	
	declare c2 cursor for 
				select policy_key, a.policy_id, a.policy_number, a.product_code, record_start_datetime, record_end_datetime, record_current_flag
				from Data.dim_policy a 
				join (select max(policy_id) policy_id, product_code 
							from Data.dim_policy 
							where product_code in ('cci','gap','lnm','mbi','posm','tar')
							group by product_code) b
					on a.policy_id = b.policy_id and a.product_code = b.product_code
					where last_updated is null
	
	-- Process update statement in Source DB for diffrent scenarios
	open c1
	fetch c1 into @vDestinationTable, @vDestinationColumn, @vSourceTableName, @vSourceColumnName, @vSourceDataType, @vsqlnotes
	WHILE @@FETCH_STATUS = 0  
	BEGIN
		set @vstartdatetime = getdate() AT TIME ZONE 'UTC' AT TIME ZONE 'New Zealand Standard Time'

		EXEC sp_execute_remote @data_source_name  = N'linked_sourcedb', @stmt = @vsqlnotes 

		--print @vsqlnotes

		fetch c1 into @vDestinationTable, @vDestinationColumn, @vSourceTableName, @vSourceColumnName, @vSourceDataType, @vsqlnotes
	END
	close c1
	
	-- ETL proc to update target table
	exec @vsqletlsp

	set @venddatetime = getdate() AT TIME ZONE 'UTC' AT TIME ZONE 'New Zealand Standard Time'

	delete from dbo.dim_policy_test_results
	--Fetch each scenario again to compare the values against target table
	open c1
	fetch c1 into @vDestinationTable, @vDestinationColumn, @vSourceTableName, @vSourceColumnName, @vSourceDataType, @vsqlnotes
	WHILE @@FETCH_STATUS = 0  
	BEGIN
		if @vSourceDataType = 'Num' 
			set @vSourceColumnName = CONVERT(VARCHAR(255), @vSourceColumnName) 
		else if @vSourceDataType = 'Date'
			set @vSourceColumnName = CONVERT(VARCHAR(255), @vSourceColumnName, 120)
		else 
			set @vSourceColumnName = @vSourceColumnName

		set @vsqldynamic = N'select @vsourcecolumnvalue = ' + @vSourceColumnName 
										+ N' from ext_piclos.' +@vSourceTableName 
										+ N' where id in (select max(id) from ext_piclos.'+@vSourceTableName + N')'
		--print @vsqldynamic

		-- Fetch updated table/column value from source
		exec sp_executesql 	@vsqldynamic, N'@vsourcecolumnvalue varchar(max) output', @vsourcecolumnvalue=@vsourcecolumnvalue OUTPUT 
		--select @vsourcecolumnvalue
		open c2
		fetch c2 into  @vTypeKey, @vPolicyID, @vPolicyNumber, @vProductCode, @vrecord_startdatetime, @vrecord_enddatetime, @vrecord_currentflag
		WHILE @@FETCH_STATUS = 0  
		BEGIN
			IF (LEFT (@vProductCode,3) = LEFT(@vSourceTableName,3))
			BEGIN
				
				if @vSourceDataType = 'Num' 
					set @vDestinationColumn = CONVERT(VARCHAR(255), @vDestinationColumn) 
				else if @vSourceDataType = 'Date'
					set @vDestinationColumn = CONVERT(VARCHAR(255), @vDestinationColumn, 120)
				else 
					set @vDestinationColumn = @vDestinationColumn
					
					
				set @vsqldynamic = N'select @vdestinationcolumnvalue = ' + @vDestinationColumn 
										+ N' from data.' +@VDestinationTable 
										+ N' where policy_key = ' + convert(nvarchar, @vTypeKey)
										
				--Fetch updated column value from target table
				exec sp_executesql 	@vsqldynamic, N'@vdestinationcolumnvalue varchar(max) output', @vdestinationcolumnvalue=@vdestinationcolumnvalue OUTPUT 
				
				if @vSourceDataType = 'Num' 
					set @vDestinationPrevColumnValue = CONVERT(VARCHAR(255), @vDestinationPrevColumnValue) 
				else if @vSourceDataType = 'Date'
					set @vDestinationPrevColumnValue = CONVERT(VARCHAR(255), @vDestinationPrevColumnValue, 120)
				else 
					set @vDestinationPrevColumnValue = @vDestinationPrevColumnValue
					
					
				set @vsqldynamic = N'select @vDestinationPrevColumnValue = ' + @vDestinationColumn 
										+ N' from data.' +@VDestinationTable 
										+ N' where policy_id = ' + convert(nvarchar, @vPolicyID)
										+ N' and record_end_datetime between ' + N'''' + convert(nvarchar, @vstartdatetime, 121) + N''''  
										+' and ' + + N'''' + convert(nvarchar, @venddatetime, 121) + N'''' 
				--print @vsqldynamic						
				--Fetch previous column value from target table
				exec sp_executesql 	@vsqldynamic, N'@vDestinationPrevColumnValue varchar(max) output', @vDestinationPrevColumnValue=@vDestinationPrevColumnValue OUTPUT 

				set @vDestinationPrevColumnValue = isnull(@vDestinationPrevColumnValue,'N/A')

				-- to compare only date up to seconds 'yyyy-mm-dd hh:mm:ss' because source table is datetime2

				--  select auto_expired_timestamp, * from ext_piclos.cci_policy where id in (select max(id) from ext_piclos.cci_policy )
				if @vSourceDataType = 'Date'
				begin
				   --some datetime coversion fails here fail here auto_expired_timestamp is one example
				   --set @vdestinationcolumnvalue = CONVERT(datetime, @vdestinationcolumnvalue, 120)
				   set @vsourcecolumnvalue = CONVERT(datetime, @vsourcecolumnvalue, 120)
				end

				if RIGHT(@vDestinationColumn,6) = 'amount'
				begin
				   set @vdestinationcolumnvalue = CONVERT(decimal(19,5), @vdestinationcolumnvalue)
				   set @vsourcecolumnvalue = CONVERT(decimal(19,5), @vsourcecolumnvalue)
				end
				
				set @vsourcetargetvalues = 'SourceValue:'+ @vsourcecolumnvalue +'|' 
														 +'TargetValue:'+ @vdestinationcolumnvalue +'|' 

														 +'TargetPrevValue:'+ @vDestinationPrevColumnValue +'|'

				-- Compare values to pass or fail the test case
				if @vrecord_startdatetime > @vstartdatetime and @vrecord_startdatetime < @venddatetime
				and @vsourcecolumnvalue = @vdestinationcolumnvalue and @vDestinationPrevColumnValue <> @vdestinationcolumnvalue
				begin
				   set @vrecord_start_datetpass = '1'
					if @vrecord_enddatetime = '2049-12-31 00:00:00.000'
					   set @vrecord_end_datepass = '1'
					else 
					   set @vrecord_end_datepass = '0'

					if @vrecord_currentflag = '1'
					   set @vcurrentflagpass = '1'
					else 
					   set @vcurrentflagpass = '0'
				end
				else 
				begin 
				   set @vrecord_start_datetpass = '0'
				   set @vrecord_end_datepass = '0'
				   set @vcurrentflagpass = '0'
				end
				insert into dbo.dim_policy_test_results 
					(tablename, columnname, sourcetablename, sourcecolumnname, policy_key, policy_id, policy_number, product_code, currentflagpass, record_start_datetpass, record_end_datepass, sourcetargetvalues, update_datetime)
					values (@vDestinationTable, @vDestinationColumn, @vSourceTableName, @vSourceColumnName, @vTypeKey, @vPolicyID, @vPolicyNumber, @vProductCode, @vcurrentflagpass, @vrecord_start_datetpass, @vrecord_end_datepass, @vsourcetargetvalues, @venddatetime)

			END
			fetch c2 into  @vTypeKey, @vPolicyID, @vPolicyNumber, @vProductCode, @vrecord_startdatetime, @vrecord_enddatetime, @vrecord_currentflag
		END
		close c2
		fetch c1 into @vDestinationTable, @vDestinationColumn, @vSourceTableName, @vSourceColumnName, @vSourceDataType, @vsqlnotes
	END
	close c1
	deallocate c1
	deallocate c2
	select * from dbo.dim_policy_test_results order by update_datetime

END
GO

select * from dbo.dim_policy_test_case
select * from dbo.dim_policy_test_results  
--exec [dbo].[udsp_test_dim_policy_v2]

--exec [sp_data].[populate_dim_policy]

IF EXISTS (select * from sys.sysobjects where name = 'dim_policy_test_results')
	DROP TABLE dbo.dim_policy_test_results

	CREATE TABLE  dbo.dim_policy_test_results 
		(
			tablename varchar(255) NOT NULL,
			columnname varchar(255) NOT NULL,
			sourcetablename varchar(255) NOT NULL,
			sourcecolumnname varchar(255) NOT NULL,
			policy_key		int  null,
			policy_id		int  null,
			policy_number varchar(100)  null,
			product_code	varchar(4)  null,
			currentflagpass varchar(1) NOT NULL,
			record_start_datetpass varchar(1) NOT NULL,
			record_end_datepass varchar(1) NOT NULL,
			sourcetargetvalues varchar(max) null,
			update_datetime	datetime null
		)

IF EXISTS (select * from sys.sysobjects where name = 'dim_policy_test_case')
	DROP TABLE dbo.dim_policy_test_case

CREATE TABLE dbo.dim_policy_test_case
(DestinationTable		varchar(255),
 DestinationColumn		varchar(255),
 SourceTableName		varchar(255),
 SourceColumnName		varchar(255),
 SourceDataType			varchar(10), 
 sqlnotes				nvarchar(max),
CONSTRAINT [PK_dim_policy_ts] PRIMARY KEY CLUSTERED 
(
	DestinationTable ASC,
	DestinationColumn ASC,
	SourceTableName ASC,
	SourceColumnName ASC,
	SourceDataType	ASC 
)WITH (STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


DELETE A FROM 
[dbo].[dim_policy_test_case] a
INNER JOIN [dbo].[dim_policy_test_results]  b on B.tablename = A.DestinationTable and B.columnname = A.DestinationColumn 
 and B.sourcetablename = A.SourceTableName and B.sourcecolumnname = A.SourceColumnName

delete from dbo.dim_policy_test_case 
--select * from dbo.dim_policy_test_case

--exec [dbo].[udsp_test_dim_policy_v2]

INSERT INTO dbo.dim_policy_test_case VALUES 
('dim_policy','quote_id','posm_policy','quote_id','Num',N'update piclos.posm_policy set quote_id = isnull(quote_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
--,('dim_policy','cover_type_id & cover_type_name','posm_policy','cover_type_id','Num',N'update piclos.posm_policy set cover_type_id = 2 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
--,('dim_policy','cover_type_id & cover_type_name','gap_policy','cover_type_id','Num',N'update piclos.gap_policy set cover_type_id = 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
--,('dim_policy','cover_type_id & cover_type_name','cci_policy','cover_type_id','Num',N'update piclos.cci_policy set cover_type_id = 2 , cover_type_name = ''Test Cover 2'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
--,('dim_policy','cover_type_id & cover_type_name','lnm_policy','cover_type_id','Num',N'update piclos.lnm_policy set cover_type_id =  2 , cover_type_name = ''Test Cover 2'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
--,('dim_policy','cover_type_id & cover_type_name','mbi_policy','cover_type_id','Num',N'update piclos.mbi_policy set cover_type_id = 2, cover_type_name = ''Test Cover 2'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
--,('dim_policy','cover_type_id & cover_type_name','tar_policy','cover_type_id','Num',N'update piclos.tar_policy set cover_type_id = 2, cover_type_name = ''Test Cover 2'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','cover_option_dealer_specific_flag','gap_policy','cover_option_dealer_specific','Varchar',N'update piclos.gap_policy set cover_option_dealer_specific =  case when cover_option_dealer_specific = 1 then 0 when cover_option_dealer_specific = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','cover_option_dealer_specific_flag','posm_policy','cover_option_dealer_specific','Varchar',N'update piclos.posm_policy set cover_option_dealer_specific = case when cover_option_dealer_specific = 1 then 0 when cover_option_dealer_specific = 0 then 1 end , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','cover_option_id','gap_policy','cover_option_id','Num',N'update piclos.gap_policy set cover_option_id = isnull(cover_option_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','cover_option_id','posm_policy','cover_option_id','Num',N'update piclos.posm_policy set cover_option_id = isnull(cover_option_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','cover_option_description','gap_policy','cover_option_title','Varchar',N'update piclos.gap_policy set cover_option_title = cover_option_title + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','cover_option_description','posm_policy','cover_option_title','Varchar',N'update piclos.posm_policy set cover_option_title = cover_option_title + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','dealer_id','cci_policy','dealer_id','Num',N'update piclos.cci_policy set dealer_id = isnull(dealer_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','dealer_id','gap_policy','dealer_id','Num',N'update piclos.gap_policy set dealer_id = isnull(dealer_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','dealer_id','lnm_policy','dealer_id','Num',N'update piclos.lnm_policy set dealer_id = isnull(dealer_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','dealer_id','mbi_policy','dealer_id','Num',N'update piclos.mbi_policy set dealer_id = isnull(dealer_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','dealer_id','posm_policy','dealer_id','Num',N'update piclos.posm_policy set dealer_id = isnull(dealer_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','dealer_id','tar_policy','dealer_id','Num',N'update piclos.tar_policy set dealer_id = isnull(dealer_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','dealer_user_id','cci_policy','dealer_user_id','Num',N'update piclos.cci_policy set dealer_user_id = isnull(dealer_user_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','dealer_user_id','gap_policy','dealer_user_id','Num',N'update piclos.gap_policy set dealer_user_id = isnull(dealer_user_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','dealer_user_id','lnm_policy','dealer_user_id','Num',N'update piclos.lnm_policy set dealer_user_id = isnull(dealer_user_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','dealer_user_id','mbi_policy','dealer_user_id','Num',N'update piclos.mbi_policy set dealer_user_id = isnull(dealer_user_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','dealer_user_id','posm_policy','dealer_user_id','Num',N'update piclos.posm_policy set dealer_user_id = isnull(dealer_user_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','dealer_user_id','tar_policy','dealer_user_id','Num',N'update piclos.tar_policy set dealer_user_id = isnull(dealer_user_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','dealer_name','cci_policy','dealer_name','Varchar',N'update piclos.cci_policy set dealer_name = dealer_name  + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','dealer_name','gap_policy','dealer_name','Varchar',N'update piclos.gap_policy set dealer_name = dealer_name  + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','dealer_name','lnm_policy','dealer_name','Varchar',N'update piclos.lnm_policy set dealer_name = dealer_name  + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','dealer_name','mbi_policy','dealer_name','Varchar',N'update piclos.mbi_policy set dealer_name = dealer_name  + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','dealer_name','posm_policy','dealer_name','Varchar',N'update piclos.posm_policy set dealer_name = dealer_name  + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','dealer_name','tar_policy','dealer_name','Varchar',N'update piclos.tar_policy set dealer_name = dealer_name  + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','dealer_rep_code','cci_policy','dealer_rep_code','Varchar',N'update piclos.cci_policy set dealer_rep_code = dealer_rep_code + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','dealer_rep_code','gap_policy','dealer_rep_code','Varchar',N'update piclos.gap_policy set dealer_rep_code = dealer_rep_code + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','dealer_sales_rep_name','cci_policy','dealer_sales_rep','Varchar',N'update piclos.cci_policy set dealer_sales_rep = dealer_sales_rep + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','dealer_sales_rep_name','gap_policy','dealer_sales_rep','Varchar',N'update piclos.gap_policy set dealer_sales_rep = dealer_sales_rep + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','dealer_sales_rep_name','lnm_policy','dealer_sales_rep','Varchar',N'update piclos.lnm_policy set dealer_sales_rep = dealer_sales_rep + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','dealer_sales_rep_name','posm_policy','dealer_sales_rep','Varchar',N'update piclos.posm_policy set dealer_sales_rep = dealer_sales_rep + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','dealer_sales_rep_name','mbi_policy','dealer_salesrep','Varchar',N'update piclos.mbi_policy set dealer_salesrep = dealer_salesrep + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','dealer_sales_rep_name','tar_policy','dealer_salesrep','Varchar',N'update piclos.tar_policy set dealer_salesrep = dealer_salesrep + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','dealer_deactivated_flag','cci_policy','dealer_deactivated','Varchar',N'update piclos.cci_policy set dealer_deactivated = case when dealer_deactivated = 1 then 0 when dealer_deactivated = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','dealer_deactivated_flag','gap_policy','dealer_deactivated','Varchar',N'update piclos.gap_policy set dealer_deactivated = case when dealer_deactivated = 1 then 0 when dealer_deactivated = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','dealer_deactivated_flag','mbi_policy','dealer_deactivated','Varchar',N'update piclos.mbi_policy set dealer_deactivated = case when dealer_deactivated = 1 then 0 when dealer_deactivated = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','dealer_deactivated_flag','tar_policy','dealer_deactivated','Varchar',N'update piclos.tar_policy set dealer_deactivated = case when dealer_deactivated = 1 then 0 when dealer_deactivated = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','dealer_retail_premium_amount','gap_policy','dealer_retail_premium','Num',N'update piclos.gap_policy set dealer_retail_premium = isnull(dealer_retail_premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','dealer_retail_premium_amount','mbi_policy','dealer_retail_premium','Num',N'update piclos.mbi_policy set dealer_retail_premium = isnull(dealer_retail_premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','dealer_retail_premium_amount','tar_policy','dealer_retail_premium','Num',N'update piclos.tar_policy set dealer_retail_premium = isnull(dealer_retail_premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','dealer_incentive_amount','mbi_policy','dealer_incentive','Num',N'update piclos.mbi_policy set dealer_incentive = isnull(dealer_incentive,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','rating_card_id','posm_policy','rating_card_id','Num',N'update piclos.posm_policy set rating_card_id = isnull(rating_card_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','brand_id','cci_policy','brand_id','Num',N'update piclos.cci_policy set brand_id = isnull(brand_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','brand_id','gap_policy','brand_id','Num',N'update piclos.gap_policy set brand_id = isnull(brand_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','brand_id','mbi_policy','brand_id','Num',N'update piclos.mbi_policy set brand_id = isnull(brand_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','brand_id','posm_policy','brand_id','Num',N'update piclos.posm_policy set brand_id = isnull(brand_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','brand_id','tar_policy','brand_id','Num',N'update piclos.tar_policy set brand_id = isnull(brand_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','brand_name','gap_policy','brand_name','Varchar',N'update piclos.gap_policy set brand_name = brand_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','brand_name','mbi_policy','brand_name','Varchar',N'update piclos.mbi_policy set brand_name = brand_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','brand_name','posm_policy','brand_name','Varchar',N'update piclos.posm_policy set brand_name = brand_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','brand_name','tar_policy','brand_name','Varchar',N'update piclos.tar_policy set brand_name = brand_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','branch_id','mbi_policy','branch_id','Num',N'update piclos.mbi_policy set branch_id = isnull(branch_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','branch_id','posm_policy','branch_id','Num',N'update piclos.posm_policy set branch_id = isnull(branch_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','branch_id','tar_policy','branch_id','Num',N'update piclos.tar_policy set branch_id = isnull(branch_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','branch_name','mbi_policy','branch_name','Varchar',N'update piclos.mbi_policy set branch_name = branch_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','branch_name','posm_policy','branch_name','Varchar',N'update piclos.posm_policy set branch_name = branch_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','branch_name','tar_policy','branch_name','Varchar',N'update piclos.tar_policy set branch_name = branch_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','insurance_product_id','cci_policy','insurance_product_id','Num',N'update piclos.cci_policy set insurance_product_id = isnull(insurance_product_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','insurance_product_id','gap_policy','insurance_product_id','Num',N'update piclos.gap_policy set insurance_product_id = isnull(insurance_product_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','insurance_product_id','lnm_policy','insurance_product_id','Num',N'update piclos.lnm_policy set insurance_product_id = isnull(insurance_product_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','insurance_product_id','mbi_policy','insurance_product_id','Num',N'update piclos.mbi_policy set insurance_product_id = isnull(insurance_product_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','insurance_product_id','posm_policy','insurance_product_id','Num',N'update piclos.posm_policy set insurance_product_id = isnull(insurance_product_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','insurance_product_id','tar_policy','insurance_product_id','Num',N'update piclos.tar_policy set insurance_product_id = isnull(insurance_product_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','policy_status_code','cci_policy','status','Varchar',N'update piclos.cci_policy set status = status + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','policy_status_code','gap_policy','status','Varchar',N'update piclos.gap_policy set status = status + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
--,('dim_policy','policy_status_code','lnm_policy','status','Varchar',N'update piclos.lnm_policy set status = status + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','policy_status_code','posm_policy','status','Varchar',N'update piclos.posm_policy set status = status + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_status_code','tar_policy','status','Varchar',N'update piclos.tar_policy set status = status + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','policy_status_code','mbi_policy','status','Varchar',N'update piclos.mbi_policy set status = status + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','insurance_refused_flag','posm_policy','insurance_refused','Num',N'update piclos.posm_policy set insurance_refused = case when insurance_refused = 1 then 0 when insurance_refused = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','insurance_refused_details','posm_policy','insurance_refused_details','Varchar',N'update piclos.posm_policy set insurance_refused_details = insurance_refused_details + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','refund_amount','cci_policy','refund','Num',N'update piclos.cci_policy set refund = isnull(refund,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','refund_amount','gap_policy','refund','Num',N'update piclos.gap_policy set refund = isnull(refund,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','refund_amount','mbi_policy','refund','Num',N'update piclos.mbi_policy set refund = isnull(refund,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','refund_amount','posm_policy','refund','Num',N'update piclos.posm_policy set refund = isnull(refund,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','refund_amount','tar_policy','refund','Num',N'update piclos.tar_policy set refund = isnull(refund,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','refund_by_wholesale_premium_flag','cci_policy','refund_by_wholesale_premium','Num',N'update piclos.cci_policy set refund_by_wholesale_premium = case when refund_by_wholesale_premium = 1 then 0 when refund_by_wholesale_premium = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy)')
,('dim_policy','refund_datetime','cci_policy','refund_timestamp','Date',N'update piclos.cci_policy set refund_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','refund_datetime','gap_policy','refund_timestamp','Date',N'update piclos.gap_policy set refund_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','refund_datetime','mbi_policy','refund_timestamp','Date',N'update piclos.mbi_policy set refund_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','refund_datetime','posm_policy','refund_timestamp','Date',N'update piclos.posm_policy set refund_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','refund_datetime','tar_policy','refund_timestamp','Date',N'update piclos.tar_policy set refund_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','payment_type_description','posm_policy','payment_type','Varchar',N'update piclos.posm_policy set payment_type = payment_type  + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
--,('dim_policy','payment_frequency_code','mbi_policy','payment_frequency','Varchar',N'update piclos.mbi_policy set payment_frequency = payment_frequency + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','payment_frequency_code','posm_policy','payment_freq','Varchar',N'update piclos.posm_policy set payment_freq = payment_freq + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','payment_reference_number','posm_policy','payment_ref','Varchar',N'update piclos.posm_policy set payment_ref = payment_ref + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','dob_1','cci_policy','dob_1','Date',N'update piclos.cci_policy set dob_1 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','dob_1','gap_policy','dob_1','Date',N'update piclos.gap_policy set dob_1 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','dob_1','lnm_policy','dob','Date',N'update piclos.lnm_policy set dob = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','dob_1','mbi_policy','dob_1','Date',N'update piclos.mbi_policy set dob_1 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','dob_1','posm_policy','dob_1','Date',N'update piclos.posm_policy set dob_1 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','dob_1','tar_policy','dob_1','Date',N'update piclos.tar_policy set dob_1 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','dob_2','cci_policy','dob_2','Date',N'update piclos.cci_policy set dob_2 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','dob_2','gap_policy','dob_2','Date',N'update piclos.gap_policy set dob_2 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','dob_2','mbi_policy','dob_2','Date',N'update piclos.mbi_policy set dob_2 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','dob_2','posm_policy','dob_2','Date',N'update piclos.posm_policy set dob_2 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','dob_2','tar_policy','dob_2','Date',N'update piclos.tar_policy set dob_2 = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','primary_driver_accident_free_years','posm_policy','primary_driver_accident_free_years','Num',N'update piclos.posm_policy set primary_driver_accident_free_years = isnull(primary_driver_accident_free_years,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
--('dim_policy','primary_driver_gender_code','posm_policy','primary_driver_gender','Num',N'update piclos.posm_policy set primary_driver_gender = case when primary_driver_gender = 1 then 2 when primary_driver_gender = 2 then 1 end , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','product_name','cci_policy','product_name','Varchar',N'update piclos.cci_policy set product_name = product_name + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','product_name','gap_policy','product_name','Varchar',N'update piclos.gap_policy set product_name = product_name + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','product_name','lnm_policy','product_name','Varchar',N'update piclos.lnm_policy set product_name = product_name + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','product_name','mbi_policy','product_name','Varchar',N'update piclos.mbi_policy set product_name = product_name + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','product_name','posm_policy','product_name','Varchar',N'update piclos.posm_policy set product_name = product_name + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','product_name','tar_policy','product_name','Varchar',N'update piclos.tar_policy set product_name = product_name + ''1'', last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','policy_purchase_datetime','cci_policy','purchase_timestamp','Date',N'update piclos.cci_policy set purchase_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','policy_purchase_datetime','gap_policy','purchase_timestamp','Date',N'update piclos.gap_policy set purchase_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','policy_purchase_datetime','lnm_policy','purchase_timestamp','Date',N'update piclos.lnm_policy set purchase_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','policy_purchase_datetime','mbi_policy','purchase_timestamp','Date',N'update piclos.mbi_policy set purchase_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','policy_purchase_datetime','posm_policy','purchase_timestamp','Date',N'update piclos.posm_policy set purchase_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_purchase_datetime','tar_policy','purchase_timestamp','Date',N'update piclos.tar_policy set purchase_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','invoiced_datetime','cci_policy','invoiced_timestamp','Date',N'update piclos.cci_policy set invoiced_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','invoiced_datetime','gap_policy','invoiced_timestamp','Date',N'update piclos.gap_policy set invoiced_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','invoiced_datetime','mbi_policy','invoiced_timestamp','Date',N'update piclos.mbi_policy set invoiced_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','invoiced_datetime','posm_policy','invoiced_timestamp','Date',N'update piclos.posm_policy set invoiced_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','invoiced_datetime','tar_policy','invoiced_timestamp','Date',N'update piclos.tar_policy set invoiced_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','policy_valid_from_date','cci_policy','from_timestamp','Date',N'update piclos.cci_policy set from_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','policy_valid_from_date','gap_policy','from_timestamp','Date',N'update piclos.gap_policy set from_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','policy_valid_from_date','lnm_policy','from_timestamp','Date',N'update piclos.lnm_policy set from_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','policy_valid_from_date','mbi_policy','from_timestamp','Date',N'update piclos.mbi_policy set from_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','policy_valid_from_date','posm_policy','from_timestamp','Date',N'update piclos.posm_policy set from_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_valid_from_date','tar_policy','from_timestamp','Date',N'update piclos.tar_policy set from_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','policy_valid_to_date','cci_policy','to_timestamp','Date',N'update piclos.cci_policy set to_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','policy_valid_to_date','gap_policy','to_timestamp','Date',N'update piclos.gap_policy set to_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','policy_valid_to_date','lnm_policy','to_timestamp','Date',N'update piclos.lnm_policy set to_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','policy_valid_to_date','mbi_policy','to_timestamp','Date',N'update piclos.mbi_policy set to_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','policy_valid_to_date','posm_policy','to_timestamp','Date',N'update piclos.posm_policy set to_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_valid_to_date','tar_policy','to_timestamp','Date',N'update piclos.tar_policy set to_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','policy_term_in_months','cci_policy','term','Num',N'update piclos.cci_policy set term = isnull(term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','policy_term_in_months','gap_policy','term','Num',N'update piclos.gap_policy set term = isnull(term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','policy_term_in_months','mbi_policy','term','Num',N'update piclos.mbi_policy set term = isnull(term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','policy_term_in_months','posm_policy','term','Num',N'update piclos.posm_policy set term = isnull(term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_term_in_months','tar_policy','term','Num',N'update piclos.tar_policy set term = isnull(term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','retail_premium_over_policy_term_amount','posm_policy','retail_premium_over_term','Num',N'update piclos.posm_policy set retail_premium_over_term = isnull(retail_premium_over_term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','retail_premium_annual_amount','posm_policy','retail_premium_annual','Num',N'update piclos.posm_policy set retail_premium_annual = isnull(retail_premium_annual,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','retail_premium_monthly_amount','posm_policy','retail_premium_monthly','Num',N'update piclos.posm_policy set retail_premium_monthly = isnull(retail_premium_monthly,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','retail_premium_fortnightly_amount','posm_policy','retail_premium_fortnightly','Num',N'update piclos.posm_policy set retail_premium_fortnightly = isnull(retail_premium_fortnightly,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','retail_premium_weekly_amount','posm_policy','retail_premium_weekly','Num',N'update piclos.posm_policy set retail_premium_weekly = isnull(retail_premium_weekly,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','retail_premium_amount','cci_policy','retail_premium','Num',N'update piclos.cci_policy set retail_premium = isnull(retail_premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','retail_premium_incl_gst_amount','cci_policy','retail_premium_incl_gst','Num',N'update piclos.cci_policy set retail_premium_incl_gst = isnull(retail_premium_incl_gst,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','wholesale_premium_over_term_amount','posm_policy','wholesalepremium_over_term','Num',N'update piclos.posm_policy set wholesalepremium_over_term = isnull(wholesalepremium_over_term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','wholesale_premium_amount','posm_policy','wholesalepremium','Num',N'update piclos.posm_policy set wholesalepremium = isnull(wholesalepremium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','premium_term_in_months','cci_policy','premium_term','Num',N'update piclos.cci_policy set premium_term = isnull(premium_term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','premium_amount','cci_policy','premium','Num',N'update piclos.cci_policy set premium = isnull(premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','premium_amount','gap_policy','premium','Num',N'update piclos.gap_policy set premium = isnull(premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','premium_amount','mbi_policy','premium','Num',N'update piclos.mbi_policy set premium = isnull(premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','premium_amount','posm_policy','premium','Num',N'update piclos.posm_policy set premium = isnull(premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','premium_amount','tar_policy','premium','Num',N'update piclos.tar_policy set premium = isnull(premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','premium_with_gst_amount','posm_policy','premium_with_gst','Num',N'update piclos.posm_policy set premium_with_gst = isnull(premium_with_gst,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','premium_with_gst_payable_amount','posm_policy','premium_with_gst_payable','Num',N'update piclos.posm_policy set premium_with_gst_payable = isnull(premium_with_gst_payable,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','loading_over_policy_term_amount','posm_policy','loading_amount_over_term','Num',N'update piclos.posm_policy set loading_amount_over_term = isnull(loading_amount_over_term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','loading_amount','posm_policy','loading_amount','Num',N'update piclos.posm_policy set loading_amount = isnull(loading_amount,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','loading_amount_percent','posm_policy','loading_amount_percent','Num',N'update piclos.posm_policy set loading_amount_percent = isnull(loading_amount_percent,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','additional_risk_premium_amount','posm_policy','additional_risk_premium','Num',N'update piclos.posm_policy set additional_risk_premium = isnull(additional_risk_premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','gst_amount','posm_policy','gst','Num',N'update piclos.posm_policy set gst = isnull(gst,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','gst_base_rate_amount','posm_policy','gst_base_rate','Num',N'update piclos.posm_policy set gst_base_rate = isnull(gst_base_rate,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','dps_convenience_fee_amount','posm_policy','dps_convenience_fee','Num',N'update piclos.posm_policy set dps_convenience_fee = isnull(dps_convenience_fee,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','fire_service_levy_amount','posm_policy','fire_service_levy','Num',N'update piclos.posm_policy set fire_service_levy = isnull(fire_service_levy,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','fire_service_levy_base_rate_amount','posm_policy','fire_service_levy_base_rate','Num',N'update piclos.posm_policy set fire_service_levy_base_rate = isnull(fire_service_levy_base_rate,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','fire_service_levy_with_gst_payable_amount','posm_policy','fire_service_levy_with_gst_payable','Num',N'update piclos.posm_policy set fire_service_levy_with_gst_payable = isnull(fire_service_levy_with_gst_payable,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','life_insurance_fee_amount','posm_policy','life_insurance_fee','Num',N'update piclos.posm_policy set life_insurance_fee = isnull(life_insurance_fee,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','life_insurance_fee_base_rate_percentage','posm_policy','life_insurance_fee_base_rate','Num',N'update piclos.posm_policy set life_insurance_fee_base_rate = isnull(life_insurance_fee_base_rate,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','road_side_assist_fee_amount','posm_policy','road_side_assist_fee','Num',N'update piclos.posm_policy set road_side_assist_fee = isnull(road_side_assist_fee,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','has_road_side_assist_flag','posm_policy','has_road_side_assist','Num',N'update piclos.posm_policy set has_road_side_assist = case when has_road_side_assist = 1 then 0 when has_road_side_assist = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','roadside_assist_amount','mbi_policy','roadside_assist','Num',N'update piclos.mbi_policy set roadside_assist = isnull(roadside_assist,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','is_roadside_assist_flag','mbi_policy','is_roadside_assist','Num',N'update piclos.mbi_policy set is_roadside_assist = case when is_roadside_assist = 1 then 0 when is_roadside_assist = 0 then 1 end , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','roadside_assist_end_datetime','mbi_policy','roadside_assist_end_date','Date',N'update piclos.mbi_policy set roadside_assist_end_date = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','roadside_assist_original_end_date','mbi_policy','roadside_assist_original_end_date','Date',N'update piclos.mbi_policy set roadside_assist_original_end_date = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','roadside_assist_duration_in_months','mbi_policy','roadside_assist_term','Num',N'update piclos.mbi_policy set roadside_assist_term = isnull(roadside_assist_term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','nzra_live_flag','mbi_policy','nzra_live','Num',N'update piclos.mbi_policy set nzra_live = case when nzra_live = 1 then 0 when nzra_live = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','claim_limit_amount','mbi_policy','claim_limit','Num',N'update piclos.mbi_policy set claim_limit = isnull(claim_limit,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','roadside_breakdown_notes','mbi_policy','roadside_breakdown','Varchar',N'update piclos.mbi_policy set roadside_breakdown = roadside_breakdown + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','previous_vehicle_insurance_flag','posm_policy','previous_vehicle_insurance','Num',N'update piclos.posm_policy set previous_vehicle_insurance =  case when previous_vehicle_insurance = 1 then 0 when previous_vehicle_insurance = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','other_insurance_with_us_flag','posm_policy','other_insurance_with_us','Num',N'update piclos.posm_policy set other_insurance_with_us =  case when other_insurance_with_us = 1 then 0 when other_insurance_with_us = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','other_insurance_with_us_details','posm_policy','other_insurance_with_us_details','Varchar',N'update piclos.posm_policy set other_insurance_with_us_details = other_insurance_with_us_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','sum_insured_amount','gap_policy','sum_insured','Num',N'update piclos.gap_policy set sum_insured = isnull(sum_insured,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','sum_insured_amount','posm_policy','sum_insured','Num',N'update piclos.posm_policy set sum_insured = isnull(sum_insured,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','interested_parties_id','posm_policy','interested_parties_id','Num',N'update piclos.posm_policy set interested_parties_id = isnull(interested_parties_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','interested_parties_name','posm_policy','interested_parties','Varchar',N'update piclos.posm_policy set interested_parties = interested_parties + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','excess_amount','mbi_policy','excess','Num',N'update piclos.mbi_policy set excess = isnull(excess,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','excess_amount','tar_policy','excess','Num',N'update piclos.tar_policy set excess = isnull(excess,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','wind_screen_excess_amount','posm_policy','excess_windscreen','Num',N'update piclos.posm_policy set excess_windscreen = isnull(excess_windscreen,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','under_age21_excess_amount','posm_policy','excess_under21','Num',N'update piclos.posm_policy set excess_under21 = isnull(excess_under21,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','age_21to25_excess_amount','posm_policy','excess_21to25','Num',N'update piclos.posm_policy set excess_21to25 = isnull(excess_21to25,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','standard_excess_amount','posm_policy','excess_std','Num',N'update piclos.posm_policy set excess_std = isnull(excess_std,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','mandatory_excess_amount','posm_policy','excess_mandatory_value','Num',N'update piclos.posm_policy set excess_mandatory_value = isnull(excess_mandatory_value,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','excess_optional_id','posm_policy','excess_optional_id','Num',N'update piclos.posm_policy set excess_optional_id = isnull(excess_optional_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','excess_optional_amount','posm_policy','excess_optional_value','Num',N'update piclos.posm_policy set excess_optional_value = isnull(excess_optional_value,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','overseas_license_excess_amount','posm_policy','excess_overseas','Num',N'update piclos.posm_policy set excess_overseas = isnull(excess_overseas,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','learners_license_excess_amount','posm_policy','excess_learners','Num',N'update piclos.posm_policy set excess_learners = isnull(excess_learners,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','additional_excess_amount','posm_policy','excess_additional','Num',N'update piclos.posm_policy set excess_additional = isnull(excess_additional,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','no_claims_modifier_percentage','posm_policy','no_claims_modifier','Num',N'update piclos.posm_policy set no_claims_modifier = isnull(no_claims_modifier,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','max_payable_loss_use_amount','posm_policy','max_payable_loss_use','Num',N'update piclos.posm_policy set max_payable_loss_use = isnull(max_payable_loss_use,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','named_driver_flag','posm_policy','named_driver','Num',N'update piclos.posm_policy set named_driver = case when named_driver = 1 then 0 when named_driver = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','exclude_under_age25_flag','posm_policy','exclude_under_25','Num',N'update piclos.posm_policy set exclude_under_25 = case when exclude_under_25 = 1 then 0 when exclude_under_25 = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','accident_flag','posm_policy','accident','Num',N'update piclos.posm_policy set accident = case when accident = 1 then 0 when accident = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','accident_details','posm_policy','accident_details','Varchar',N'update piclos.posm_policy set accident_details = accident_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','stolen_burnt_flag','posm_policy','stolen_burnt','Num',N'update piclos.posm_policy set stolen_burnt = case when stolen_burnt = 1 then 0 when stolen_burnt = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','stolen_burnt_details','posm_policy','stolen_burnt_details','Varchar',N'update piclos.posm_policy set stolen_burnt_details = stolen_burnt_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','underwriting_status','posm_policy','uw_status','Varchar',N'update piclos.posm_policy set uw_status = uw_status + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','underwriting_reason','posm_policy','uw_reason','Varchar',N'update piclos.posm_policy set uw_reason = uw_reason + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','underwriting_comments','posm_policy','uw_comment','Varchar',N'update piclos.posm_policy set uw_comment = uw_comment + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','duty_of_disclosure_notes','posm_policy','duty_of_disclosure','Varchar',N'update piclos.posm_policy set duty_of_disclosure = duty_of_disclosure + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','driving_offence_flag','posm_policy','driving_offence','Num',N'update piclos.posm_policy set driving_offence = case when driving_offence = 1 then 0 when driving_offence = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','driving_offence_details','posm_policy','driving_offence_details','Varchar',N'update piclos.posm_policy set driving_offence_details = driving_offence_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','licence_cancelled_flag','posm_policy','licence_cancelled','Num',N'update piclos.posm_policy set licence_cancelled = case when licence_cancelled = 1 then 0 when licence_cancelled = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','licence_cancelled_details','posm_policy','licence_cancelled_details','Varchar',N'update piclos.posm_policy set licence_cancelled_details = licence_cancelled_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','non_private_use_flag','posm_policy','non_private_use','Num',N'update piclos.posm_policy set non_private_use = case when non_private_use = 1 then 0 when non_private_use = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','non_private_use_details','posm_policy','non_private_use_details','Varchar',N'update piclos.posm_policy set non_private_use_details = non_private_use_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_modified_flag','mbi_policy','is_modified','Num',N'update piclos.mbi_policy set is_modified = case when is_modified = 1 then 0 when is_modified = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','vehicle_modified_flag','posm_policy','modified','Num',N'update piclos.posm_policy set modified = case when modified = 1 then 0 when modified = 0 then 1 end , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_modification_details','posm_policy','modified_details','Varchar',N'update piclos.posm_policy set modified_details = modified_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','claim_withdrawn_flag','posm_policy','claim_withdrawn','Num',N'update piclos.posm_policy set claim_withdrawn = case when claim_withdrawn = 1 then 0 when claim_withdrawn = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','claim_withdrawn_details','posm_policy','claim_withdrawn_details','Varchar',N'update piclos.posm_policy set claim_withdrawn_details = claim_withdrawn_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','conviction_flag','posm_policy','conviction','Num',N'update piclos.posm_policy set conviction = case when conviction = 1 then 0 when conviction = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','conviction_details','posm_policy','conviction_details','Varchar',N'update piclos.posm_policy set conviction_details = conviction_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','criminal_activity_flag','posm_policy','criminal_activity','Num',N'update piclos.posm_policy set criminal_activity = case when criminal_activity = 1 then 0 when criminal_activity = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','criminal_activity_details','posm_policy','criminal_activity_details','Varchar',N'update piclos.posm_policy set criminal_activity_details = criminal_activity_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_owned_by_other_flag','posm_policy','vehicle_owned_by_other','Num',N'update piclos.posm_policy set vehicle_owned_by_other = case when vehicle_owned_by_other = 1 then 0 when vehicle_owned_by_other = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_owned_by_other_details','posm_policy','vehicle_owned_by_other_details','Varchar',N'update piclos.posm_policy set vehicle_owned_by_other_details = vehicle_owned_by_other_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','other_factors_flag','posm_policy','other_factors','Num',N'update piclos.posm_policy set other_factors = case when other_factors = 1 then 0 when other_factors = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','other_factors_details','posm_policy','other_factors_details','Varchar',N'update piclos.posm_policy set other_factors_details = other_factors_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','information_complete_flag','posm_policy','information_complete','Num',N'update piclos.posm_policy set information_complete = case when information_complete = 1 then 0 when information_complete = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','information_complete_details','posm_policy','information_complete_details','Varchar',N'update piclos.posm_policy set information_complete_details = information_complete_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','privacy_claims_register_agree_flag','posm_policy','privacy_claims_register_agree','Num',N'update piclos.posm_policy set privacy_claims_register_agree = case when privacy_claims_register_agree = 1 then 0 when privacy_claims_register_agree = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','privacy_disclose_information_agree_flag','posm_policy','privacy_disclose_information_agree','Num',N'update piclos.posm_policy set privacy_disclose_information_agree = case when privacy_disclose_information_agree = 1 then 0 when privacy_disclose_information_agree = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','privacy_obtain_information_agree_flag','posm_policy','privacy_obtain_information_agree','Num',N'update piclos.posm_policy set privacy_obtain_information_agree = case when privacy_obtain_information_agree = 1 then 0 when privacy_obtain_information_agree = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_location_street','posm_policy','vehicle_location_street','Varchar',N'update piclos.posm_policy set vehicle_location_street = vehicle_location_street + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_location_suburb','posm_policy','vehicle_location_suburb','Varchar',N'update piclos.posm_policy set vehicle_location_suburb = vehicle_location_suburb + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_location_city','posm_policy','vehicle_location_city','Varchar',N'update piclos.posm_policy set vehicle_location_city = vehicle_location_city + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_location_postcode','posm_policy','vehicle_location_postcode','Varchar',N'update piclos.posm_policy set vehicle_location_postcode = vehicle_location_postcode + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_intended_use_business_flag','posm_policy','vehicle_intended_use_business','Num',N'update piclos.posm_policy set vehicle_intended_use_business = case when vehicle_intended_use_business = 1 then 0 when vehicle_intended_use_business = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_kept_region_id','posm_policy','vehicle_kept_region_id','Varchar',N'update piclos.posm_policy set vehicle_kept_region_id = vehicle_kept_region_id + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_kept_description','posm_policy','vehicle_kept','Varchar',N'update piclos.posm_policy set vehicle_kept = vehicle_kept + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_kept_city','posm_policy','vehicle_kept_city','Varchar',N'update piclos.posm_policy set vehicle_kept_city = vehicle_kept_city + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_kept_suburb','posm_policy','vehicle_kept_suburb','Varchar',N'update piclos.posm_policy set vehicle_kept_suburb = vehicle_kept_suburb + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_kept_address','posm_policy','vehicle_kept_address','Varchar',N'update piclos.posm_policy set vehicle_kept_address = vehicle_kept_address + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_has_alarm_flag','posm_policy','vehicle_has_alarm','Num',N'update piclos.posm_policy set vehicle_has_alarm = case when vehicle_has_alarm = 1 then 0 when vehicle_has_alarm = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_has_immobiliser_flag','posm_policy','vehicle_has_immobiliser','Num',N'update piclos.posm_policy set vehicle_has_immobiliser = case when vehicle_has_immobiliser = 1 then 0 when vehicle_has_immobiliser = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_modifications_description','posm_policy','modifications','Varchar',N'update piclos.posm_policy set modifications = modifications + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_body_kit_flag','posm_policy','vehicle_mod_body_kit','Num',N'update piclos.posm_policy set vehicle_mod_body_kit = case when vehicle_mod_body_kit = 1 then 0 when vehicle_mod_body_kit = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_decoration_flag','posm_policy','vehicle_mod_decoration','Num',N'update piclos.posm_policy set vehicle_mod_decoration = case when vehicle_mod_decoration = 1 then 0 when vehicle_mod_decoration = 0 then 1 end , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_engine_flag','posm_policy','vehicle_mod_engine','Num',N'update piclos.posm_policy set vehicle_mod_engine = case when vehicle_mod_engine = 1 then 0 when vehicle_mod_engine = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_exhaust_flag','posm_policy','vehicle_mod_exhaust','Num',N'update piclos.posm_policy set vehicle_mod_exhaust = case when vehicle_mod_exhaust = 1 then 0 when vehicle_mod_exhaust = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_gauges_flag','posm_policy','vehicle_mod_gauges','Num',N'update piclos.posm_policy set vehicle_mod_gauges = case when vehicle_mod_gauges = 1 then 0 when vehicle_mod_gauges = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_glass_flag','posm_policy','vehicle_mod_glass','Num',N'update piclos.posm_policy set vehicle_mod_glass = case when vehicle_mod_glass = 1 then 0 when vehicle_mod_glass = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_suspension_flag','posm_policy','vehicle_mod_suspension','Num',N'update piclos.posm_policy set vehicle_mod_suspension = case when vehicle_mod_suspension = 1 then 0 when vehicle_mod_suspension = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_mags_amount','posm_policy','vehicle_mod_mags_value','Num',N'update piclos.posm_policy set vehicle_mod_mags_value = isnull(vehicle_mod_mags_value,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_stereo_amount','posm_policy','vehicle_mod_stereo_value','Num',N'update piclos.posm_policy set vehicle_mod_stereo_value = isnull(vehicle_mod_stereo_value,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','vehicle_mod_other_amount','posm_policy','vehicle_mod_other_value','Num',N'update piclos.posm_policy set vehicle_mod_other_value = isnull(vehicle_mod_other_value,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','pmvs_commission_variable_amount','posm_policy','pmvs_commission_variable','Num',N'update piclos.posm_policy set pmvs_commission_variable = isnull(pmvs_commission_variable,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','pmvs_commission_fixed_amount','posm_policy','pmvs_commission_fixed','Num',N'update piclos.posm_policy set pmvs_commission_fixed = isnull(pmvs_commission_fixed,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','declaration_notes','posm_policy','declarations','Varchar',N'update piclos.posm_policy set declarations = declarations + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','xml_seq_number','posm_policy','xml_seq_no','Num',N'update piclos.posm_policy set xml_seq_no = isnull(xml_seq_no,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','is_renewal_flag','posm_policy','is_renewal','Num',N'update piclos.posm_policy set is_renewal = case when is_renewal = 1 then 0 when is_renewal = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','renewal_pending_flag','posm_policy','renewal_pending','Num',N'update piclos.posm_policy set renewal_pending = case when renewal_pending = 1 then 0 when renewal_pending = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','is_marsh_renewal_flag','posm_policy','is_marsh_renewal','Num',N'update piclos.posm_policy set is_marsh_renewal = case when is_marsh_renewal = 1 then 0 when is_marsh_renewal = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','marsh_id','posm_policy','marsh_id','Num',N'update piclos.posm_policy set marsh_id = isnull(marsh_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','posm_annual_invoice_flag','posm_policy','use_posm_annual_invoice','Num',N'update piclos.posm_policy set use_posm_annual_invoice = case when use_posm_annual_invoice = 1 then 0 when use_posm_annual_invoice = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','contract_number','cci_policy','contract_no','Varchar',N'update piclos.cci_policy set contract_no = contract_no + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','contract_number','gap_policy','contract_no','Varchar',N'update piclos.gap_policy set contract_no = contract_no + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','contract_number','mbi_policy','contract_no','Varchar',N'update piclos.mbi_policy set contract_no = contract_no + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','contract_number','posm_policy','contract_no','Varchar',N'update piclos.posm_policy set contract_no = contract_no + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','contract_number','tar_policy','contract_no','Varchar',N'update piclos.tar_policy set contract_no = contract_no + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','contract_date','mbi_policy','contract_date','Date',N'update piclos.mbi_policy set contract_date = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','contract_date','tar_policy','contract_date','Date',N'update piclos.tar_policy set contract_date = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','legacy_policy_number','posm_policy','policy_number_legacy','Varchar',N'update piclos.posm_policy set policy_number_legacy = policy_number_legacy + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','pmvs_policy_id','posm_policy','pmvs_policy_id','Num',N'update piclos.posm_policy set pmvs_policy_id = isnull(pmvs_policy_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','parent_policy_id','posm_policy','policy_id_parent','Num',N'update piclos.posm_policy set policy_id_parent = isnull(policy_id_parent,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','child_policy_id','posm_policy','policy_id_child','Num',N'update piclos.posm_policy set policy_id_child = isnull(policy_id_child,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_type_id','posm_policy','policy_type_id','Num',N'update piclos.posm_policy set policy_type_id = isnull(policy_type_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_notes','posm_policy','policy_notes','Varchar',N'update piclos.posm_policy set policy_notes = policy_notes + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_holder_licence_type_flag','posm_policy','policy_holder_licence_type','Num',N'update piclos.posm_policy set policy_holder_licence_type = case when policy_holder_licence_type = 1 then 0 when policy_holder_licence_type = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_holder_has_licence_suspended_flag','posm_policy','policy_holder_has_licence_suspended','Num',N'update piclos.posm_policy set policy_holder_has_licence_suspended = case when policy_holder_has_licence_suspended = 1 then 0 when policy_holder_has_licence_suspended = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_holder_has_previous_claims_flag','posm_policy','policy_holder_has_previous_claims','Num',N'update piclos.posm_policy set policy_holder_has_previous_claims = case when policy_holder_has_previous_claims = 1 then 0 when policy_holder_has_previous_claims = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_holder_has_vehicle_loss_flag','posm_policy','policy_holder_has_vehicle_loss','Num',N'update piclos.posm_policy set policy_holder_has_vehicle_loss = case when policy_holder_has_vehicle_loss = 1 then 0 when policy_holder_has_vehicle_loss = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_holder_has_driving_offences_flag','posm_policy','policy_holder_has_driving_offences','Num',N'update piclos.posm_policy set policy_holder_has_driving_offences = case when policy_holder_has_driving_offences = 1 then 0 when policy_holder_has_driving_offences = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_holder_has_criminal_offence_flag','posm_policy','policy_holder_has_criminal_offence','Num',N'update piclos.posm_policy set policy_holder_has_criminal_offence = case when policy_holder_has_criminal_offence = 1 then 0 when policy_holder_has_criminal_offence = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_holder_has_criminal_offence_bankrupt_flag','posm_policy','policy_holder_has_criminal_offence_bankrupt','Num',N'update piclos.posm_policy set policy_holder_has_criminal_offence_bankrupt = case when policy_holder_has_criminal_offence_bankrupt = 1 then 0 when policy_holder_has_criminal_offence_bankrupt = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_holder_has_criminal_offence_prosecution_flag','posm_policy','policy_holder_has_criminal_offence_prosecution','Num',N'update piclos.posm_policy set policy_holder_has_criminal_offence_prosecution = case when policy_holder_has_criminal_offence_prosecution = 1 then 0 when policy_holder_has_criminal_offence_prosecution = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_holder_has_criminal_offence_convicted_flag','posm_policy','policy_holder_has_criminal_offence_convicted','Num',N'update piclos.posm_policy set policy_holder_has_criminal_offence_convicted = case when policy_holder_has_criminal_offence_convicted = 1 then 0 when policy_holder_has_criminal_offence_convicted = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_booklet_version','cci_policy','policy_booklet_version','Num',N'update piclos.cci_policy set policy_booklet_version = isnull(policy_booklet_version,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','policy_booklet_version','gap_policy','policy_booklet_version','Num',N'update piclos.gap_policy set policy_booklet_version = isnull(policy_booklet_version,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','policy_booklet_version','lnm_policy','policy_booklet_version','Num',N'update piclos.lnm_policy set policy_booklet_version = isnull(policy_booklet_version,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','policy_booklet_version','mbi_policy','policy_booklet_version','Num',N'update piclos.mbi_policy set policy_booklet_version = isnull(policy_booklet_version,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','policy_booklet_version','posm_policy','policy_booklet_version','Num',N'update piclos.posm_policy set policy_booklet_version = isnull(policy_booklet_version,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','policy_booklet_version','tar_policy','policy_booklet_version','Num',N'update piclos.tar_policy set policy_booklet_version = isnull(policy_booklet_version,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','policy_booklet_name','cci_policy','policy_booklet_name','Varchar',N'update piclos.cci_policy set policy_booklet_name = policy_booklet_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','policy_booklet_name','gap_policy','policy_booklet_name','Varchar',N'update piclos.gap_policy set policy_booklet_name = policy_booklet_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','policy_booklet_name','mbi_policy','policy_booklet_name','Varchar',N'update piclos.mbi_policy set policy_booklet_name = policy_booklet_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','policy_booklet_name','tar_policy','policy_booklet_name','Varchar',N'update piclos.tar_policy set policy_booklet_name = policy_booklet_name + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','is_policy_disabled_flag','cci_policy','is_disabled','Num',N'update piclos.cci_policy set is_disabled = case when is_disabled = 1 then 0 when is_disabled = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','is_policy_disabled_flag','gap_policy','is_disabled','Num',N'update piclos.gap_policy set is_disabled = case when is_disabled = 1 then 0 when is_disabled = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','is_policy_disabled_flag','mbi_policy','is_disabled','Num',N'update piclos.mbi_policy set is_disabled = case when is_disabled = 1 then 0 when is_disabled = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','is_policy_disabled_flag','tar_policy','is_disabled','Num',N'update piclos.tar_policy set is_disabled = case when is_disabled = 1 then 0 when is_disabled = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','responsible_lending_terms_acknowledge_flag','cci_policy','responsible_lending_terms_acknowledge','Num',N'update piclos.cci_policy set responsible_lending_terms_acknowledge = case when responsible_lending_terms_acknowledge= 1 then 0 when responsible_lending_terms_acknowledge= 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','responsible_lending_terms_acknowledge_flag','gap_policy','responsible_lending_terms_acknowledge','Num',N'update piclos.gap_policy set responsible_lending_terms_acknowledge = case when responsible_lending_terms_acknowledge= 1 then 0 when responsible_lending_terms_acknowledge= 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','responsible_lending_terms_acknowledge_flag','mbi_policy','responsible_lending_terms_acknowledge','Num',N'update piclos.mbi_policy set responsible_lending_terms_acknowledge = case when responsible_lending_terms_acknowledge= 1 then 0 when responsible_lending_terms_acknowledge= 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','responsible_lending_terms_acknowledge_flag','posm_policy','responsible_lending_terms_acknowledge','Num',N'update piclos.posm_policy set responsible_lending_terms_acknowledge = case when responsible_lending_terms_acknowledge= 1 then 0 when responsible_lending_terms_acknowledge= 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','responsible_lending_terms_acknowledge_flag','tar_policy','responsible_lending_terms_acknowledge','Num',N'update piclos.tar_policy set responsible_lending_terms_acknowledge = case when responsible_lending_terms_acknowledge= 1 then 0 when responsible_lending_terms_acknowledge= 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','auto_expired_datetime','cci_policy','auto_expired_timestamp','Date',N'update piclos.cci_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','auto_expired_datetime','gap_policy','auto_expired_timestamp','Date',N'update piclos.gap_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','auto_expired_datetime','mbi_policy','auto_expired_timestamp','Date',N'update piclos.mbi_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','auto_expired_datetime','posm_policy','auto_expired_timestamp','Date',N'update piclos.posm_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','auto_expired_datetime','tar_policy','auto_expired_timestamp','Date',N'update piclos.tar_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','cancelled_datetime','posm_policy','cancelled_timestamp','Date',N'update piclos.posm_policy set cancelled_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','deactivated_datetime','cci_policy','deactivated_timestamp','Date',N'update piclos.cci_policy set deactivated_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','deactivated_datetime','gap_policy','deactivated_timestamp','Date',N'update piclos.gap_policy set deactivated_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','deactivated_datetime','mbi_policy','deactivated_timestamp','Date',N'update piclos.mbi_policy set deactivated_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','deactivated_datetime','posm_policy','deactivated_timestamp','Date',N'update piclos.posm_policy set deactivated_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
,('dim_policy','deactivated_datetime','tar_policy','deactivated_timestamp','Date',N'update piclos.tar_policy set deactivated_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','insurance_type_code','cci_policy','insurance_type','Varchar',N'update piclos.cci_policy set insurance_type = insurance_type + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','e_delivery_pref_code','cci_policy','e_delivery_pref','Varchar',N'update piclos.cci_policy set e_delivery_pref = e_delivery_pref + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','e_delivery_pref_code','gap_policy','e_delivery_pref','Varchar',N'update piclos.gap_policy set e_delivery_pref = e_delivery_pref + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','e_delivery_pref_code','mbi_policy','e_delivery_pref','Varchar',N'update piclos.mbi_policy set e_delivery_pref = e_delivery_pref + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','e_delivery_pref_code','tar_policy','e_delivery_pref','Varchar',N'update piclos.tar_policy set e_delivery_pref = e_delivery_pref + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','send_edocs_now_flag','cci_policy','send_edocs_now','Num',N'update piclos.cci_policy set send_edocs_now = case when send_edocs_now = 1 then 0 when send_edocs_now = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','send_edocs_now_flag','gap_policy','send_edocs_now','Num',N'update piclos.gap_policy set send_edocs_now = case when send_edocs_now = 1 then 0 when send_edocs_now = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','send_edocs_now_flag','mbi_policy','send_edocs_now','Num',N'update piclos.mbi_policy set send_edocs_now = case when send_edocs_now = 1 then 0 when send_edocs_now = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','send_edocs_now_flag','tar_policy','send_edocs_now','Num',N'update piclos.tar_policy set send_edocs_now = case when send_edocs_now = 1 then 0 when send_edocs_now = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','sent_to_ecm_flag','cci_policy','sent_to_ecm','Num',N'update piclos.cci_policy set sent_to_ecm = case when sent_to_ecm = 1 then 0 when sent_to_ecm = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','sent_to_ecm_flag','gap_policy','sent_to_ecm','Num',N'update piclos.gap_policy set sent_to_ecm = case when sent_to_ecm = 1 then 0 when sent_to_ecm = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','sent_to_ecm_flag','mbi_policy','sent_to_ecm','Num',N'update piclos.mbi_policy set sent_to_ecm = case when sent_to_ecm = 1 then 0 when sent_to_ecm = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','sent_to_ecm_flag','tar_policy','sent_to_ecm','Num',N'update piclos.tar_policy set sent_to_ecm = case when sent_to_ecm = 1 then 0 when sent_to_ecm = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','created_by_wholesale_premium_flag','cci_policy','created_by_wholesale_premium','Num',N'update piclos.cci_policy set created_by_wholesale_premium = case when created_by_wholesale_premium = 1 then 0 when created_by_wholesale_premium = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','financier_name','cci_policy','financier','Varchar',N'update piclos.cci_policy set financier = financier + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','financier_name','gap_policy','financier','Varchar',N'update piclos.gap_policy set financier = financier + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','financed_amount','cci_policy','amount_financed','Num',N'update piclos.cci_policy set amount_financed = isnull(amount_financed,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','financed_amount','gap_policy','amount_financed','Num',N'update piclos.gap_policy set amount_financed = isnull(amount_financed,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','balance_payable_amount','cci_policy','balance_payable','Num',N'update piclos.cci_policy set balance_payable = isnull(balance_payable,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','balance_payable_amount','gap_policy','balance_payable','Num',N'update piclos.gap_policy set balance_payable = isnull(balance_payable,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','financed_from_datetime','cci_policy','finance_from_timestamp','Date',N'update piclos.cci_policy set finance_from_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','financed_from_datetime','gap_policy','finance_from_timestamp','Date',N'update piclos.gap_policy set finance_from_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','finance_term_in_months','cci_policy','finance_term','Num',N'update piclos.cci_policy set finance_term = isnull(finance_term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','finance_term_in_months','gap_policy','finance_term','Num',N'update piclos.gap_policy set finance_term = isnull(finance_term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','monthly_installments_amount','cci_policy','monthly_installments','Num',N'update piclos.cci_policy set monthly_installments = isnull(monthly_installments,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','balloon_payments_notes','cci_policy','balloon_payments','Varchar',N'update piclos.cci_policy set balloon_payments = balloon_payments + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','underwriting_premium_amount','cci_policy','underwriting_premium','Num',N'update piclos.cci_policy set underwriting_premium = isnull(underwriting_premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','additional_notes','cci_policy','please_note','Varchar',N'update piclos.cci_policy set please_note = please_note + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','additional_notes','gap_policy','please_note','Varchar',N'update piclos.gap_policy set please_note = please_note + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','additional_notes','mbi_policy','please_note','Varchar',N'update piclos.mbi_policy set please_note = please_note + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','additional_notes','tar_policy','please_note','Varchar',N'update piclos.tar_policy set please_note = please_note + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','financial_rating_notes','cci_policy','financial_rating','Varchar',N'update piclos.cci_policy set financial_rating = financial_rating + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','financial_rating_notes','gap_policy','financial_rating','Varchar',N'update piclos.gap_policy set financial_rating = financial_rating + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','financial_rating_notes','mbi_policy','financial_rating','Varchar',N'update piclos.mbi_policy set financial_rating = financial_rating + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','financial_rating_notes','tar_policy','financial_rating','Varchar',N'update piclos.tar_policy set financial_rating = financial_rating + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','acknowledgment_notes','cci_policy','acknowledgments','Varchar',N'update piclos.cci_policy set acknowledgments = acknowledgments + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','acknowledgment_notes','gap_policy','acknowledgments','Varchar',N'update piclos.gap_policy set acknowledgments = acknowledgments + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','acknowledgment_notes','mbi_policy','acknowledgments','Varchar',N'update piclos.mbi_policy set acknowledgments = acknowledgments + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','acknowledgment_notes','tar_policy','acknowledgments','Varchar',N'update piclos.tar_policy set acknowledgments = acknowledgments + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','other_details','cci_policy','other_details','Varchar',N'update piclos.cci_policy set other_details = other_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','other_details','gap_policy','other_details','Varchar',N'update piclos.gap_policy set other_details = other_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','other_details','mbi_policy','other_details','Varchar',N'update piclos.mbi_policy set other_details = other_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','other_details','tar_policy','other_details','Varchar',N'update piclos.tar_policy set other_details = other_details + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','policy_event_coverage_causes','cci_policy','causes','Varchar',N'update piclos.cci_policy set causes = causes + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','alert_backdated_flag','cci_policy','alert_backdated','Num',N'update piclos.cci_policy set alert_backdated = case when alert_backdated = 1 then 0 when alert_backdated = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
,('dim_policy','alert_backdated_flag','gap_policy','alert_backdated','Num',N'update piclos.gap_policy set alert_backdated = case when alert_backdated = 1 then 0 when alert_backdated = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','alert_backdated_flag','lnm_policy','alert_backdated','Num',N'update piclos.lnm_policy set alert_backdated = case when alert_backdated = 1 then 0 when alert_backdated = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','alert_backdated_flag','mbi_policy','alert_backdated','Num',N'update piclos.mbi_policy set alert_backdated = case when alert_backdated = 1 then 0 when alert_backdated = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','alert_backdated_flag','tar_policy','alert_backdated','Num',N'update piclos.tar_policy set alert_backdated = case when alert_backdated = 1 then 0 when alert_backdated = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','gap_amount','gap_policy','gap_amount','Num',N'update piclos.gap_policy set gap_amount = isnull(gap_amount,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','special_benefits_amount','gap_policy','special_benefits','Num',N'update piclos.gap_policy set special_benefits = isnull(special_benefits,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','financier_id','gap_policy','financier_id','Num',N'update piclos.gap_policy set financier_id = isnull(financier_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
,('dim_policy','legacy_soi_number','lnm_policy','legacy_soi_number','Varchar',N'update piclos.lnm_policy set legacy_soi_number = isnull(legacy_soi_number,0) + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','request_approval_flag','lnm_policy','request_approval','Num',N'update piclos.lnm_policy set request_approval = case when request_approval = 1 then 0 when request_approval = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','policyholder_benefit_id','lnm_policy','benefit_for_policyholder','Num',N'update piclos.lnm_policy set benefit_for_policyholder = isnull(benefit_for_policyholder,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','loan_number','lnm_policy','loan_number','Varchar',N'update piclos.lnm_policy set loan_number = loan_number + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','which_insured_flag','lnm_policy','which_insured','Num',N'update piclos.lnm_policy set which_insured = case when which_insured = 1 then 0 when which_insured = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','new_loan_type_id','lnm_policy','new_loan_type','Num',N'update piclos.lnm_policy set new_loan_type = isnull(new_loan_type,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','loan_balance_amount','lnm_policy','loan_balance','Num',N'update piclos.lnm_policy set loan_balance = isnull(loan_balance,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','loan_total_amount','lnm_policy','loan_total','Num',N'update piclos.lnm_policy set loan_total = isnull(loan_total,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','other_outstanding_loans_flag','lnm_policy','other_outstanding_loans','Num',N'update piclos.lnm_policy set other_outstanding_loans = case when other_outstanding_loans = 1 then 0 when other_outstanding_loans = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','balance_already_covered_amount','lnm_policy','balance_already_covered','Num',N'update piclos.lnm_policy set balance_already_covered = isnull(balance_already_covered,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.lnm_policy where id in (select max(id) from piclos.lnm_policy )')
,('dim_policy','excess_id','mbi_policy','excess_id','Num',N'update piclos.mbi_policy set excess_id = isnull(excess_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','excess_id','tar_policy','excess_id','Num',N'update piclos.tar_policy set excess_id = isnull(excess_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','claim_limit_tyres_amount','tar_policy','claim_limit_tyres','Num',N'update piclos.tar_policy set claim_limit_tyres = isnull(claim_limit_tyres,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','claim_limit_rims_amount','tar_policy','claim_limit_rims','Num',N'update piclos.tar_policy set claim_limit_rims = isnull(claim_limit_rims,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','dispensations_notes','mbi_policy','dispensations','Varchar',N'update piclos.mbi_policy set dispensations = dispensations + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','dispensations_notes','tar_policy','dispensations','Varchar',N'update piclos.tar_policy set dispensations = dispensations + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','original_duration_in_months','mbi_policy','original_term','Num',N'update piclos.mbi_policy set original_term = isnull(original_term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','original_duration_in_months','tar_policy','original_term','Num',N'update piclos.tar_policy set original_term = isnull(original_term,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','original_excess_amount','mbi_policy','original_excess','Num',N'update piclos.mbi_policy set original_excess = isnull(original_excess,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','original_excess_amount','tar_policy','original_excess','Num',N'update piclos.tar_policy set original_excess = isnull(original_excess,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','original_premium_amount','mbi_policy','original_premium','Num',N'update piclos.mbi_policy set original_premium = isnull(original_premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','original_premium_amount','tar_policy','original_premium','Num',N'update piclos.tar_policy set original_premium = isnull(original_premium,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','original_claim_limit_amount','mbi_policy','original_claim_limit','Num',N'update piclos.mbi_policy set original_claim_limit = isnull(original_claim_limit,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','original_claim_limit_tyres_amount','tar_policy','original_claim_limit_tyres','Num',N'update piclos.tar_policy set original_claim_limit_tyres = isnull(original_claim_limit_tyres,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','original_claim_limit_rims_amount','tar_policy','original_claim_limit_rims','Num',N'update piclos.tar_policy set original_claim_limit_rims = isnull(original_claim_limit_rims,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','adhoc_set_flag','mbi_policy','adhoc_set','Num',N'update piclos.mbi_policy set adhoc_set = case when adhoc_set= 1 then 0 when adhoc_set= 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','adhoc_set_flag','tar_policy','adhoc_set','Num',N'update piclos.tar_policy set adhoc_set = case when adhoc_set= 1 then 0 when adhoc_set= 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','adhoc_dispensation_notes','mbi_policy','adhoc_dispensation','Varchar',N'update piclos.mbi_policy set adhoc_dispensation = adhoc_dispensation + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','adhoc_dispensation_notes','tar_policy','adhoc_dispensation','Varchar',N'update piclos.tar_policy set adhoc_dispensation = adhoc_dispensation + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','adhoc_modified_by_user_id','mbi_policy','adhoc_modified_by','Num',N'update piclos.mbi_policy set adhoc_modified_by = isnull(adhoc_modified_by,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','adhoc_modified_by_user_id','tar_policy','adhoc_modified_by','Num',N'update piclos.tar_policy set adhoc_modified_by = isnull(adhoc_modified_by,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','adhoc_modified_datetime','mbi_policy','adhoc_modified_timestamp','Date',N'update piclos.mbi_policy set adhoc_modified_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','adhoc_modified_datetime','tar_policy','adhoc_modified_timestamp','Date',N'update piclos.tar_policy set adhoc_modified_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
,('dim_policy','is_transferred_flag','mbi_policy','is_transferred','Num',N'update piclos.mbi_policy set is_transferred = case when is_transferred = 1 then 0 when is_transferred = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','latest_transfer_id','mbi_policy','latest_transfer_id','Num',N'update piclos.mbi_policy set latest_transfer_id = isnull(latest_transfer_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','premium_funded_flag','mbi_policy','premium_funded','Num',N'update piclos.mbi_policy set premium_funded = case when premium_funded= 1 then 0 when premium_funded= 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','payment_instalment_amount','mbi_policy','payment_instalment','Num',N'update piclos.mbi_policy set payment_instalment = isnull(payment_instalment,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','recurring_schedule_payment_number','mbi_policy','payment_number_of_payments','Num',N'update piclos.mbi_policy set payment_number_of_payments = isnull(payment_number_of_payments,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','recurring_schedule_number_of_months','mbi_policy','payment_number_of_months','Num',N'update piclos.mbi_policy set payment_number_of_months = isnull(payment_number_of_months,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','payment_total_amount','mbi_policy','payment_total_amount','Num',N'update piclos.mbi_policy set payment_total_amount = isnull(payment_total_amount,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','commission_code','mbi_policy','commission_type','Varchar',N'update piclos.mbi_policy set commission_type = ISNULL(commission_type,0) + ''1'' , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','commission_rate','mbi_policy','commission_rate','Num',N'update piclos.mbi_policy set commission_rate = isnull(commission_rate,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','commission_total_amount','mbi_policy','commission_total','Num',N'update piclos.mbi_policy set commission_total = isnull(commission_total,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','commission_report_file_dump_date','mbi_policy','commission_report_file_dump_date','Date',N'update piclos.mbi_policy set commission_report_file_dump_date = dateadd(m,1,getdate()) , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','is_special_extended_cover_flag','mbi_policy','is_special_extended_cover','Num',N'update piclos.mbi_policy set is_special_extended_cover = case when is_special_extended_cover = 1 then 0 when is_special_extended_cover = 0 then 1 end, last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
,('dim_policy','promotion_id','mbi_policy','promotion_id','Num',N'update piclos.mbi_policy set promotion_id = isnull(promotion_id,0) + 1 , last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')


delete dbo.dim_policy_test_case
INSERT INTO dbo.dim_policy_test_case VALUES 
('dim_policy','auto_expired_datetime','cci_policy','auto_expired_timestamp','Date',N'update piclos.cci_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.cci_policy where id in (select max(id) from piclos.cci_policy )')
--,('dim_policy','auto_expired_datetime','gap_policy','auto_expired_timestamp','Date',N'update piclos.gap_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.gap_policy where id in (select max(id) from piclos.gap_policy )')
--,('dim_policy','auto_expired_datetime','mbi_policy','auto_expired_timestamp','Date',N'update piclos.mbi_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.mbi_policy where id in (select max(id) from piclos.mbi_policy )')
--,('dim_policy','auto_expired_datetime','posm_policy','auto_expired_timestamp','Date',N'update piclos.posm_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.posm_policy where id in (select max(id) from piclos.posm_policy )')
--,('dim_policy','auto_expired_datetime','tar_policy','auto_expired_timestamp','Date',N'update piclos.tar_policy set auto_expired_timestamp = dateadd(m,1,getdate()), last_updated = getdate() AT TIME ZONE ''UTC'' AT TIME ZONE ''New Zealand Standard Time'' from piclos.tar_policy where id in (select max(id) from piclos.tar_policy )')
